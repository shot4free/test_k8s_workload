---

nginx-ingress:
  controller:
    autoscaling:
      minReplicas: 10
    resources:
      requests:
        cpu: 1
        memory: 1G
  nodeSelector:
    cloud.google.com/gke-nodepool: default-3

registry:
  middleware:
    storage:
      - name: googlecdn
        options:
          baseurl: cdn.registry.gitlab-static.net
          privatekeySecret:
            secret: registry-cdn-private-key-v1
            key: private-key
          keyname: gprd-registry-cdn
          ipfilteredby: gcp
  hpa:
    # min is set higher for https://gitlab.com/gitlab-com/gl-infra/delivery/-/issues/2380
    # and should stay above 20 until we solve https://gitlab.com/gitlab-com/gl-infra/delivery/-/issues/1510
    minReplicas: 50
    maxReplicas: 90
  resources:
    requests:
      memory: 3G
  database:
    # This setting should not be disabled (unless we decide to do a full rollback during Phase 1 of the
    # upgrade/migration, in which case we have to first copy the bucket data from the new prefix to the
    # old prefix). Disabling this would cause repositories that were registered on the database to
    # become inaccessible. In case of an issue with the upgrade/migration, we should instead turn off
    # the `container_registry_migration_phase1` feature flag
    # (https://gitlab.com/gitlab-org/gitlab/-/issues/335703), which will pause the addition of _more_
    # repositories to the database while continuing to serve requests for those already there.
    enabled: true
    host: pgbouncer-registry.int.gprd.gitlab.net
    port: 6432
    user: gitlab-registry
    name: gitlabhq_registry
    connecttimeout: 5s
    draintimeout: 15s
    password:
      secret: registry-postgresql-password-v1
    pool:
      maxopen: 30
      maxidle: 15
      maxlifetime: 30m
      maxidletime: 5m
  migration:
    # This setting should not be disabled in case of a rollback. Please see the comments for the
    # `database.enabled` configuration parameter for additional details (the same applies here).
    enabled: true
    rootdirectory: gitlab
    disablemirrorfs: true
    tagconcurrency: 6
    importtimeout: 30m
    preimporttimeout: 48h
    importnotification:
      enabled: true
  storage:
    secret: registry-storage-v4
  # When enabled, the upload purger will attempt to make deletes against the
  # common GCS bucket. It is not suitable to be enabled in production until the
  # following issues are resolved:
  # https://gitlab.com/gitlab-org/container-registry/-/issues/216
  # https://gitlab.com/gitlab-org/container-registry/-/issues/217
  maintenance:
    uploadpurging:
      enabled: false
  gc:
    disabled: false
    blobs:
      interval: 1s
  validation:
    disabled: false
    manifests:
      referencelimit: 200
      payloadsizelimit: 256000
      urls:
        # this is needed to keep backwards compatibility when `validation.disabled: false`, as by default an empty `allow` means no URLs are allowed
        allow:
          - .*

gitlab:
  gitlab-pages:
    hpa:
      minReplicas: 2
      maxReplicas: 20
      targetAverageValue: 800m
    resources:
      requests:
        cpu: 1000m
        memory: 5G
      limits:
        memory: 7G
  gitlab-shell:
    config:
      loginGraceTime: 120
    resources:
      limits:
        memory: 1.5G
      requests:
        cpu: 2000m
    hpa:
      targetAverageValue: 1200m
    minReplicas: 100
    maxReplicas: 150
    nodeSelector:
      cloud.google.com/gke-nodepool: shell-3
    serviceAccount:
      annotations:
        iam.gke.io/gcp-service-account: gitlab-gitlab-shell@{{ .Values.google_project }}.iam.gserviceaccount.com
  mailroom:
    image:
      repository: dev.gitlab.org:5005/gitlab/charts/components/images/gitlab-mailroom
      # Pin the tag to avoid following the chart default
      # https://gitlab.com/groups/gitlab-com/gl-infra/-/epics/201
      tag: 0.0.19
      pullSecrets:
        - name: dev-registry-access-v1
    nodeSelector:
      cloud.google.com/gke-nodepool: default-3
    workhorse:
      scheme: 'https'
      host: 'int.gprd.gitlab.net'
      port: 11443
  webservice:
    deployments:
      api:
        hpa:
          minReplicas: 25
          targetAverageValue: 3600m
        nodeSelector:
          cloud.google.com/gke-nodepool: api-2
        workhorse:
          resources:
            limits:
              memory: 2G
            requests:
              cpu: 600m
              memory: 300M
        resources:
          limits:
            memory: 12G
          requests:
            cpu: 4500m
            memory: 7G
      git:
        hpa:
          maxReplicas: 200
        nodeSelector:
          cloud.google.com/gke-nodepool: git-https-2
      web:
        hpa:
          minReplicas: 25
          maxReplicas: 150
          targetAverageValue: 3000m
        nodeSelector:
          cloud.google.com/gke-nodepool: web-1
        resources:
          limits:
            memory: 12G
          requests:
            cpu: 4500m
            memory: 7G
        workerProcesses: 6
      websockets:
        hpa:
          minReplicas: 2
        nodeSelector:
          cloud.google.com/gke-nodepool: websockets-2
        resources:
          limits:
            memory: 12G
          requests:
            memory: 6G
        workhorse:
          resources:
            limits:
              memory: 4G
            requests:
              memory: 2G
    minReplicas: 30
    maxReplicas: 150
    extraEnv:
      GITLAB_THROTTLE_BYPASS_HEADER: "X-GitLab-RateLimit-Bypass"
      DISABLE_PUMA_NAKAYOSHI_FORK: "true"
      GITLAB_PERFORMANCE_BAR_STATS_URL: "https://log.gprd.gitlab.net/app/dashboards#/view/823ed530-655a-11eb-a318-db81ec4462fa?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-24h%2Cto%3Anow))"
      GITLAB_LOG_DEPRECATIONS: "true"
      GITLAB_LOAD_BALANCING_REUSE_PRIMARY_ci: "main"
      GITLAB_MULTIPLE_DATABASE_METRICS: "true"
      # https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5950
      GITLAB_ENABLE_QUERY_ANALYZERS: "true"
      ENABLE_CROSS_DATABASE_MODIFICATION_DETECTION: "true"
      GEO_SECONDARY_PROXY: "0"
    workhorse:
      sentryDSN: "https://2d4033147e9e4d38a071aca58bc816a8@sentry.gitlab.net/14"
  kas:
    nodeSelector:
      cloud.google.com/gke-nodepool: default-3
    service:
      # gcloud compute address kas-internal-gke-gprd
      loadBalancerIP: 10.216.8.102
    workhorse:
      scheme: 'https'
      host: 'int.gprd.gitlab.net'
      port: 11443
    resources:
      limits:
        memory: 1024M
      requests:
        cpu: 100m
        memory: 768M
    hpa:
      targetAverageValue: 300m
    minReplicas: 8
    maxReplicas: 15
    customConfig:
      observability:
        sentry:
          dsn: https://af4940ad841b46d78708595fc654af78@sentry.gitlab.net/124
          environment: {{ .Environment.Values | getOrNil "env_prefix" }}
        google_profiler:
          enabled: true
  sidekiq:
    extraEnv:
      SIDEKIQ_SEMI_RELIABLE_FETCH_TIMEOUT: 5
      GITLAB_LOG_DEPRECATIONS: "true"
      GITLAB_LOAD_BALANCING_REUSE_PRIMARY_ci: "main"
      GITLAB_MULTIPLE_DATABASE_METRICS: "true"
      # https://gitlab.com/gitlab-com/gl-infra/production/-/issues/5950
      GITLAB_ENABLE_QUERY_ANALYZERS: "true"
      ENABLE_CROSS_DATABASE_MODIFICATION_DETECTION: "true"
    extraInitContainers: |
      - name: write-instance-name
        args:
          - -c
          - echo "$INSTANCE_NAME" > /etc/gitlab/instance_name
        command:
          - sh
        env:
          - name: INSTANCE_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.nodeName
        image: 'busybox:latest'
        volumeMounts:
          - mountPath: /etc/gitlab
            name: sidekiq-secrets
    psql:
      database: gitlabhq_production_sidekiq
      host: pgbouncer-sidekiq.int.gprd.gitlab.net
      load_balancing:
        discover:
          nameserver: <%= File.read('/etc/gitlab/instance_name').strip %>
          record: db-replica.service.consul.
          record_type: SRV
          port: 8600
          use_tcp: true
      ci:
        databaseTasks: false
        host: pgbouncer-sidekiq-ci.int.gprd.gitlab.net
        load_balancing:
          discover:
            nameserver: <%= File.read('/etc/gitlab/instance_name').strip %>
            record: ci-db-replica.service.consul.
            record_type: SRV
            port: 8600
            use_tcp: true
    pods:
      - name: catchall
        common:
          labels:
            shard: catchall
        hpa:
          targetAverageValue: 600m
        concurrency: 15
        minReplicas: 56
        maxReplicas: 300
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-catchall-2
        podLabels:
          shard: catchall
          deployment: sidekiq-catchall
        queueSelector: false
        queues: default,mailers,project_import_schedule
        resources:
          requests:
            cpu: 800m
            memory: 1.7G
          limits:
            cpu: 1.5
            memory: 2.5G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"catchall\"}"
        extraVolumes: |
          # This is needed because of https://gitlab.com/gitlab-org/gitlab/-/issues/330317
          # where temp files are written to `/srv/gitlab/shared`
          - name: sidekiq-shared
            emptyDir:
              sizeLimit: 10G
      - name: imports
        common:
          labels:
            shard: imports
        concurrency: 1
        minReplicas: 10
        maxReplicas: 10
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-catchall-2
        podLabels:
          deployment: sidekiq-imports
          shard: imports
        queueSelector: false
        queues: imports
        resources:
          requests:
            cpu: 800m
            memory: 2G
          limits:
            cpu: 1.5
            memory: 4G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"imports\"}"
      - name: memory-bound
        common:
          labels:
            shard: memory-bound
        concurrency: 3
        minReplicas: 8
        maxReplicas: 60
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-memory-bound-3
        podLabels:
          shard: memory-bound
          deployment: sidekiq-memory-bound
        queueSelector: false
        queues: memory_bound
        resources:
          requests:
            cpu: 500m
            memory: 3G
          limits:
            cpu: 2
            memory: 8G
        extraVolumeMounts: |
          - name: sidekiq-shared
            mountPath: /srv/gitlab/shared
            readOnly: false
        extraVolumes: |
          - name: sidekiq-shared
            emptyDir:
              sizeLimit: 70G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"memory-bound\"}"
      # Run background migrations in their own shard
      - name: database-throttled
        common:
          labels:
            shard: database-throttled
        concurrency: 5 # Discussion on this value in https://gitlab.com/gitlab-com/gl-infra/k8s-workloads/gitlab-com/-/merge_requests/276/diffs#note_367270352
        minReplicas: 1
        maxReplicas: 1
        nodeSelector:
          cloud.google.com/gke-nodepool: default-3
        podLabels:
          shard: database-throttled
          deployment: sidekiq-database-throttled
        queueSelector: false
        queues: database_throttled
        resources:
          requests:
            cpu: 500m
            memory: 3G
          limits:
            cpu: 1.5
            memory: 8G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"database-throttled\"}"
      # Run Gitaly Storage Migrations on their own shards
      # https://gitlab.com/gitlab-com/gl-infra/scalability/-/issues/436
      # Allow up to a maximum of 24 concurrent gitaly-throttled jobs
      - name: gitaly-throttled
        common:
          labels:
            shard: gitaly-throttled
        concurrency: 8
        minReplicas: 1
        maxReplicas: 3
        nodeSelector:
          cloud.google.com/gke-nodepool: default-3
        podLabels:
          shard: gitaly-throttled
          deployment: sidekiq-gitaly-throttled
        queueSelector: false
        queues: gitaly_throttled
        resources:
          requests:
            cpu: 500m
            memory: 1300M
          limits:
            cpu: 1.5
            memory: 6G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"gitaly-throttled\"}"
      - name: elasticsearch
        common:
          labels:
            shard: elasticsearch
        concurrency: 2
        minReplicas: 2
        maxReplicas: 8
        nodeSelector:
          cloud.google.com/gke-nodepool: default-3
        podLabels:
          shard: elasticsearch
          deployment: sidekiq-elasticsearch
        queueSelector: false
        queues: elasticsearch
        resources:
          requests:
            cpu: 800m
            memory: 2G
          limits:
            cpu: 2
            memory: 8G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"elasticsearch\"}"
      # Production resources for this shard discussed in
      # https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/10445
      # https://gitlab.com/gitlab-com/gl-infra/delivery/-/issues/901
      - name: low-urgency-cpu-bound
        common:
          labels:
            shard: low-urgency-cpu-bound
        concurrency: 5
        minReplicas: 10
        maxReplicas: 100
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-low-urgency-cpu-bound-2
        podLabels:
          shard: low-urgency-cpu-bound
          deployment: sidekiq-low-urgency-cpu-bound
        queueSelector: false
        queues: low_urgency_cpu_bound
        resources:
          requests:
            cpu: 1
            memory: 5G
          limits:
            cpu: 1.5
            memory: 6G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"low-urgency-cpu-bound\"}"
      # This is a shard that segregates seemingly problematic queues
      - name: quarantine
        common:
          labels:
            shard: quarantine
        concurrency: 15
        minReplicas: 10
        maxReplicas: 50
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-catchall-2
        podLabels:
          shard: quarantine
          deployment: sidekiq-quarantine
        queueSelector: false
        queues: quarantine
        resources:
          requests:
            cpu: 800m
            memory: 1.7G
          limits:
            cpu: 1.5
            memory: 2.5G
        extraEnv:
          ENABLE_LOAD_BALANCING_FOR_SIDEKIQ: "true"
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"quarantine\"}"
      # Production resources for urgent-cpu-bound discussed in
      # https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/10639
      - name: urgent-cpu-bound
        common:
          labels:
            shard: urgent-cpu-bound
        concurrency: 4
        hpa:
          targetAverageValue: 400m
        minReplicas: 36
        maxReplicas: 156
        memoryKiller:
          checkInterval: 3
          graceTime: 900
          maxRss: 3000000
          shutdownWait: 30
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-urgent-cpu-bound-2
        podLabels:
          shard: urgent-cpu-bound
          deployment: sidekiq-urgent-cpu-bound
        queueSelector: false
        queues: urgent_cpu_bound
        resources:
          requests:
            cpu: 650m
            memory: 2.5G
          limits:
            cpu: 2
            memory: 3.1G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"urgent-cpu-bound\"}"
      # Production resources for this shard discussed in
      # https://gitlab.com/gitlab-com/gl-infra/infrastructure/-/issues/10446
      - name: urgent-other
        common:
          labels:
            shard: urgent-other
        concurrency: 5
        minReplicas: 175
        maxReplicas: 175
        memoryKiller:
          checkInterval: 3
          graceTime: 900
          maxRss: 2900000
          shutdownWait: 30
        nodeSelector:
          cloud.google.com/gke-nodepool: sidekiq-urgent-other-4
        podLabels:
          shard: urgent-other
          deployment: sidekiq-urgent-other
        queueSelector: false
        queues: urgent_other,email_receiver,service_desk_email_receiver
        resources:
          requests:
            cpu: 500m
            memory: 2G
          limits:
            cpu: 1.5
            memory: 3G
        extraEnv:
          GITLAB_SENTRY_EXTRA_TAGS: "{\"type\": \"sidekiq\", \"stage\": \"main\", \"shard\": \"urgent-other\"}"

global:
  email:
    from: gitlab@mg.gitlab.com
  appConfig:
    artifacts:
      bucket: gitlab-gprd-artifacts
    contentSecurityPolicy:
      enabled: true
      report_only: false
      directives:
        connect_src: "'self' https://gitlab.com wss://gitlab.com https://sentry.gitlab.net https://customers.gitlab.com https://snowplow.trx.gitlab.net https://sourcegraph.com https://ec2.ap-east-1.amazonaws.com https://ec2.ap-northeast-1.amazonaws.com https://ec2.ap-northeast-2.amazonaws.com https://ec2.ap-northeast-3.amazonaws.com https://ec2.ap-south-1.amazonaws.com https://ec2.ap-southeast-1.amazonaws.com https://ec2.ap-southeast-2.amazonaws.com https://ec2.ca-central-1.amazonaws.com https://ec2.eu-central-1.amazonaws.com https://ec2.eu-north-1.amazonaws.com https://ec2.eu-west-1.amazonaws.com https://ec2.eu-west-2.amazonaws.com https://ec2.eu-west-3.amazonaws.com https://ec2.me-south-1.amazonaws.com https://ec2.sa-east-1.amazonaws.com https://ec2.us-east-1.amazonaws.com https://ec2.us-east-2.amazonaws.com https://ec2.us-west-1.amazonaws.com https://ec2.us-west-2.amazonaws.com https://ec2.af-south-1.amazonaws.com https://iam.amazonaws.com"
        frame_ancestors: "'self'"
        frame_src: "'self' https://www.google.com/recaptcha/ https://www.recaptcha.net/ https://content.googleapis.com https://content-cloudresourcemanager.googleapis.com https://content-compute.googleapis.com https://content-cloudbilling.googleapis.com https://*.codesandbox.io https://customers.gitlab.com"
        img_src: "* data: blob:"
        object_src: "'none'"
        script_src: "'strict-dynamic' 'self' 'unsafe-inline' 'unsafe-eval' https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/ https://www.recaptcha.net/ https://apis.google.com"
        style_src: "'self' 'unsafe-inline'"
        worker_src: "https://gitlab.com blob: data:"
        report_uri: "https://sentry.gitlab.net/api/105/security/?sentry_key=a42ea3adc19140d9a6424906e12fba86"
    cron_jobs:
      schedule_migrate_external_diffs_worker:
        cron: "*/1 * * * *"
    dependencyProxy:
      enabled: true
      bucket: gitlab-gprd-dependency-proxy
    externalDiffs:
      enabled: true
      bucket: gitlab-gprd-external-diffs
    incomingEmail:
      address: "incoming+%{key}@incoming.gitlab.com"
      user: incoming@gitlab.com
      deliveryMethod: webhook
      authToken:
        secret: gitlab-mailroom-imap-v2
        key: incoming_email_auth_token
    lfs:
      bucket: gitlab-gprd-lfs-objects
    omniauth:
      providers:
        - secret: gitlab-google-oauth2-v1
        - secret: gitlab-twitter-oauth2-v1
        - secret: gitlab-github-oauth2-v1
        - secret: gitlab-bitbucket-oauth2-v1
        - secret: gitlab-group-saml-oauth2-v1
        - secret: gitlab-salesforce-oauth2-v1
    packages:
      bucket: gitlab-gprd-package-repo
    sentry:
      clientside_dsn: https://526a2f38a53d44e3a8e69bfa001d1e8b@sentry.gitlab.net/15
      dsn: https://c0d96870a71a4217adfe015d2bd926c2:69ccdf0a405c41b78e05ab18d92bfa8d@sentry.gitlab.net/2
      environment: gprd
    serviceDeskEmail:
      enabled: true
      address: "contact-project+%{key}@incoming.gitlab.com"
      user: contact-project@incoming.gitlab.com
      deliveryMethod: webhook
      authToken:
        secret: gitlab-mailroom-imap-v2
        key: service_desk_email_auth_token
    sidekiq:
      routingRules:
        # We cannot migrate these workers yet: https://gitlab.com/gitlab-org/gitlab/-/issues/340630 / https://gitlab.com/gitlab-com/gl-infra/scalability/-/issues/1263 / https://gitlab.com/gitlab-org/gitlab/-/issues/340629
        - ["tags=needs_own_queue", null]
        - ["worker_name=AuthorizedProjectUpdate::UserRefreshFromReplicaWorker,AuthorizedProjectUpdate::UserRefreshWithLowUrgencyWorker", "quarantine"] # move this to the quarantine shard
        - ["worker_name=RepositoryImportWorker", "imports"] # imports
        - ["resource_boundary=cpu&urgency=high", "urgent_cpu_bound"] # urgent-cpu-bound
        - ["resource_boundary=memory", "memory_bound"] # memory-bound
        - ["feature_category=global_search&urgency=throttled", "elasticsearch"] # elasticsearch
        - ["resource_boundary!=cpu&urgency=high", "urgent_other"] # urgent-other
        - ["resource_boundary=cpu&urgency=default,low", "low_urgency_cpu_bound"] # low-urgency-cpu-bound
        - ["feature_category=database&urgency=throttled", "database_throttled"] # database-throttled
        - ["feature_category=gitaly&urgency=throttled", "gitaly_throttled"] # gitaly-throttled
        - ["*", "default"] # catchall on k8s
    terraformState:
      enabled: true
      bucket: gitlab-gprd-terraform-state
    ciSecureFiles:
      enabled: true
      bucket: gitlab-gprd-ci-secure-files
      connection:
        secret: gitlab-object-storage-v1
        key: gitlab-object-storage.yml
    uploads:
      bucket: gitlab-gprd-uploads
    extra:
      oneTrustId: 7f944245-c5cd-4eed-a90e-dd955adfdd08
      googleTagManagerNonceId: GTM-NJXWQL

  gitaly:
    external:
      - hostname: file-01-stor-gprd.c.gitlab-production.internal
        name: default
        port: "9999"
        tlsEnabled: false
      - hostname: file-01-stor-gprd.c.gitlab-production.internal
        name: nfs-file01
        port: "9999"
        tlsEnabled: false
      - hostname: file-02-stor-gprd.c.gitlab-production.internal
        name: nfs-file02
        port: "9999"
        tlsEnabled: false
      - hostname: file-03-stor-gprd.c.gitlab-production.internal
        name: nfs-file03
        port: "9999"
        tlsEnabled: false
      - hostname: file-04-stor-gprd.c.gitlab-production.internal
        name: nfs-file04
        port: "9999"
        tlsEnabled: false
      - hostname: file-05-stor-gprd.c.gitlab-production.internal
        name: nfs-file05
        port: "9999"
        tlsEnabled: false
      - hostname: file-06-stor-gprd.c.gitlab-production.internal
        name: nfs-file06
        port: "9999"
        tlsEnabled: false
      - hostname: file-07-stor-gprd.c.gitlab-production.internal
        name: nfs-file07
        port: "9999"
        tlsEnabled: false
      - hostname: file-08-stor-gprd.c.gitlab-production.internal
        name: nfs-file08
        port: "9999"
        tlsEnabled: false
      - hostname: file-09-stor-gprd.c.gitlab-production.internal
        name: nfs-file09
        port: "9999"
        tlsEnabled: false
      - hostname: file-10-stor-gprd.c.gitlab-production.internal
        name: nfs-file10
        port: "9999"
        tlsEnabled: false
      - hostname: file-11-stor-gprd.c.gitlab-production.internal
        name: nfs-file11
        port: "9999"
        tlsEnabled: false
      - hostname: file-12-stor-gprd.c.gitlab-production.internal
        name: nfs-file12
        port: "9999"
        tlsEnabled: false
      - hostname: file-13-stor-gprd.c.gitlab-production.internal
        name: nfs-file13
        port: "9999"
        tlsEnabled: false
      - hostname: file-14-stor-gprd.c.gitlab-production.internal
        name: nfs-file14
        port: "9999"
        tlsEnabled: false
      - hostname: file-15-stor-gprd.c.gitlab-production.internal
        name: nfs-file15
        port: "9999"
        tlsEnabled: false
      - hostname: file-16-stor-gprd.c.gitlab-production.internal
        name: nfs-file16
        port: "9999"
        tlsEnabled: false
      - hostname: file-17-stor-gprd.c.gitlab-production.internal
        name: nfs-file17
        port: "9999"
        tlsEnabled: false
      - hostname: file-18-stor-gprd.c.gitlab-production.internal
        name: nfs-file18
        port: "9999"
        tlsEnabled: false
      - hostname: file-19-stor-gprd.c.gitlab-production.internal
        name: nfs-file19
        port: "9999"
        tlsEnabled: false
      - hostname: file-20-stor-gprd.c.gitlab-production.internal
        name: nfs-file20
        port: "9999"
        tlsEnabled: false
      - hostname: file-21-stor-gprd.c.gitlab-production.internal
        name: nfs-file21
        port: "9999"
        tlsEnabled: false
      - hostname: file-22-stor-gprd.c.gitlab-production.internal
        name: nfs-file22
        port: "9999"
        tlsEnabled: false
      - hostname: file-23-stor-gprd.c.gitlab-production.internal
        name: nfs-file23
        port: "9999"
        tlsEnabled: false
      - hostname: file-24-stor-gprd.c.gitlab-production.internal
        name: nfs-file24
        port: "9999"
        tlsEnabled: false
      - hostname: file-25-stor-gprd.c.gitlab-production.internal
        name: nfs-file25
        port: "9999"
        tlsEnabled: false
      - hostname: file-26-stor-gprd.c.gitlab-production.internal
        name: nfs-file26
        port: "9999"
        tlsEnabled: false
      - hostname: file-27-stor-gprd.c.gitlab-production.internal
        name: nfs-file27
        port: "9999"
        tlsEnabled: false
      - hostname: file-28-stor-gprd.c.gitlab-production.internal
        name: nfs-file28
        port: "9999"
        tlsEnabled: false
      - hostname: file-29-stor-gprd.c.gitlab-production.internal
        name: nfs-file29
        port: "9999"
        tlsEnabled: false
      - hostname: file-30-stor-gprd.c.gitlab-production.internal
        name: nfs-file30
        port: "9999"
        tlsEnabled: false
      - hostname: file-31-stor-gprd.c.gitlab-production.internal
        name: nfs-file31
        port: "9999"
        tlsEnabled: false
      - hostname: file-32-stor-gprd.c.gitlab-production.internal
        name: nfs-file32
        port: "9999"
        tlsEnabled: false
      - hostname: file-33-stor-gprd.c.gitlab-production.internal
        name: nfs-file33
        port: "9999"
        tlsEnabled: false
      - hostname: file-34-stor-gprd.c.gitlab-production.internal
        name: nfs-file34
        port: "9999"
        tlsEnabled: false
      - hostname: file-35-stor-gprd.c.gitlab-production.internal
        name: nfs-file35
        port: "9999"
        tlsEnabled: false
      - hostname: file-36-stor-gprd.c.gitlab-production.internal
        name: nfs-file36
        port: "9999"
        tlsEnabled: false
      - hostname: file-37-stor-gprd.c.gitlab-production.internal
        name: nfs-file37
        port: "9999"
        tlsEnabled: false
      - hostname: file-38-stor-gprd.c.gitlab-production.internal
        name: nfs-file38
        port: "9999"
        tlsEnabled: false
      - hostname: file-39-stor-gprd.c.gitlab-production.internal
        name: nfs-file39
        port: "9999"
        tlsEnabled: false
      - hostname: file-40-stor-gprd.c.gitlab-production.internal
        name: nfs-file40
        port: "9999"
        tlsEnabled: false
      - hostname: file-41-stor-gprd.c.gitlab-production.internal
        name: nfs-file41
        port: "9999"
        tlsEnabled: false
      - hostname: file-42-stor-gprd.c.gitlab-production.internal
        name: nfs-file42
        port: "9999"
        tlsEnabled: false
      - hostname: file-43-stor-gprd.c.gitlab-production.internal
        name: nfs-file43
        port: "9999"
        tlsEnabled: false
      - hostname: file-44-stor-gprd.c.gitlab-production.internal
        name: nfs-file44
        port: "9999"
        tlsEnabled: false
      - hostname: file-45-stor-gprd.c.gitlab-production.internal
        name: nfs-file45
        port: "9999"
        tlsEnabled: false
      - hostname: file-46-stor-gprd.c.gitlab-production.internal
        name: nfs-file46
        port: "9999"
        tlsEnabled: false
      - hostname: file-47-stor-gprd.c.gitlab-production.internal
        name: nfs-file47
        port: "9999"
        tlsEnabled: false
      - hostname: file-48-stor-gprd.c.gitlab-production.internal
        name: nfs-file48
        port: "9999"
        tlsEnabled: false
      - hostname: file-49-stor-gprd.c.gitlab-production.internal
        name: nfs-file49
        port: "9999"
        tlsEnabled: false
      - hostname: file-50-stor-gprd.c.gitlab-production.internal
        name: nfs-file50
        port: "9999"
        tlsEnabled: false
      - hostname: file-51-stor-gprd.c.gitlab-production.internal
        name: nfs-file51
        port: "9999"
        tlsEnabled: false
      - hostname: file-52-stor-gprd.c.gitlab-production.internal
        name: nfs-file52
        port: "9999"
        tlsEnabled: false
      - hostname: file-53-stor-gprd.c.gitlab-production.internal
        name: nfs-file53
        port: "9999"
        tlsEnabled: false
      - hostname: file-54-stor-gprd.c.gitlab-production.internal
        name: nfs-file54
        port: "9999"
        tlsEnabled: false
      - hostname: file-55-stor-gprd.c.gitlab-production.internal
        name: nfs-file55
        port: "9999"
        tlsEnabled: false
      - hostname: file-56-stor-gprd.c.gitlab-production.internal
        name: nfs-file56
        port: "9999"
        tlsEnabled: false
      - hostname: file-57-stor-gprd.c.gitlab-production.internal
        name: nfs-file57
        port: "9999"
        tlsEnabled: false
      - hostname: file-58-stor-gprd.c.gitlab-production.internal
        name: nfs-file58
        port: "9999"
        tlsEnabled: false
      - hostname: file-59-stor-gprd.c.gitlab-production.internal
        name: nfs-file59
        port: "9999"
        tlsEnabled: false
      - hostname: file-60-stor-gprd.c.gitlab-production.internal
        name: nfs-file60
        port: "9999"
        tlsEnabled: false
      - hostname: file-61-stor-gprd.c.gitlab-production.internal
        name: nfs-file61
        port: "9999"
        tlsEnabled: false
      - hostname: file-62-stor-gprd.c.gitlab-production.internal
        name: nfs-file62
        port: "9999"
        tlsEnabled: false
      - hostname: file-63-stor-gprd.c.gitlab-production.internal
        name: nfs-file63
        port: "9999"
        tlsEnabled: false
      - hostname: file-64-stor-gprd.c.gitlab-production.internal
        name: nfs-file64
        port: "9999"
        tlsEnabled: false
      - hostname: file-65-stor-gprd.c.gitlab-production.internal
        name: nfs-file65
        port: "9999"
        tlsEnabled: false
      - hostname: file-66-stor-gprd.c.gitlab-production.internal
        name: nfs-file66
        port: "9999"
        tlsEnabled: false
      - hostname: file-67-stor-gprd.c.gitlab-production.internal
        name: nfs-file67
        port: "9999"
        tlsEnabled: false
      - hostname: file-68-stor-gprd.c.gitlab-production.internal
        name: nfs-file68
        port: "9999"
        tlsEnabled: false
      - hostname: file-69-stor-gprd.c.gitlab-production.internal
        name: nfs-file69
        port: "9999"
        tlsEnabled: false
      - hostname: file-70-stor-gprd.c.gitlab-production.internal
        name: nfs-file70
        port: "9999"
        tlsEnabled: false
      - hostname: file-71-stor-gprd.c.gitlab-production.internal
        name: nfs-file71
        port: "9999"
        tlsEnabled: false
      - hostname: file-72-stor-gprd.c.gitlab-production.internal
        name: nfs-file72
        port: "9999"
        tlsEnabled: false
      - hostname: file-73-stor-gprd.c.gitlab-production.internal
        name: nfs-file73
        port: "9999"
        tlsEnabled: false
      - hostname: file-74-stor-gprd.c.gitlab-production.internal
        name: nfs-file74
        port: "9999"
        tlsEnabled: false
      - hostname: file-75-stor-gprd.c.gitlab-production.internal
        name: nfs-file75
        port: "9999"
        tlsEnabled: false
      - hostname: i.gprd-gcp-tcp-lb-internal-praefect.il4.us-east1.lb.gitlab-production.internal
        name: praefect-file01
        port: "2305"
        tlsEnabled: false
      - hostname: file-cny-01-stor-gprd.c.gitlab-production.internal
        name: nfs-file-cny01
        port: "9999"
        tlsEnabled: false
      - hostname: file-marquee-01-stor-gprd.c.gitlab-production.internal
        name: nfs-file-marquee01
        port: "9999"
        tlsEnabled: false
      - hostname: file-marquee-02-stor-gprd.c.gitlab-production.internal
        name: nfs-file-marquee02
        port: "9999"
        tlsEnabled: false
      - hostname: file-marquee-03-stor-gprd.c.gitlab-production.internal
        name: nfs-file-marquee03
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-01-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd01
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-02-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd02
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-03-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd03
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-04-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd04
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-05-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd05
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-06-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd06
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-07-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd07
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-08-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd08
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-09-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd09
        port: "9999"
        tlsEnabled: false
      - hostname: file-hdd-10-stor-gprd.c.gitlab-production.internal
        name: nfs-file-hdd10
        port: "9999"
        tlsEnabled: false

  hosts:
    gitlab:
      name: gitlab.com
    kas:
      name: kas.gitlab.com
    registry:
      name: registry.gitlab.com

  redis:
    cache:
      host: gprd-redis-cache
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-cache-sentinel-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-cache-sentinel-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-cache-sentinel-03-db-gprd.c.gitlab-production.internal
        port: 26379
    host: gprd-redis
    password:
      enabled: true
      key: secret
      secret: gitlab-redis-credential-v1
    queues:
      host: gprd-redis-sidekiq
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-sidekiq-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-sidekiq-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-sidekiq-03-db-gprd.c.gitlab-production.internal
        port: 26379
    rateLimiting:
      host: gprd-redis-ratelimiting
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-ratelimiting-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-ratelimiting-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-ratelimiting-03-db-gprd.c.gitlab-production.internal
        port: 26379
    sessions:
      host: gprd-redis-sessions
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-sessions-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-sessions-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-sessions-03-db-gprd.c.gitlab-production.internal
        port: 26379
    sentinels:
    - host: redis-01-db-gprd.c.gitlab-production.internal
      port: 26379
    - host: redis-02-db-gprd.c.gitlab-production.internal
      port: 26379
    - host: redis-03-db-gprd.c.gitlab-production.internal
      port: 26379
    sharedState:
      host: gprd-redis
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-03-db-gprd.c.gitlab-production.internal
        port: 26379
    traceChunks:
      host: gprd-redis-tracechunks
      password:
        enabled: true
        key: secret
        secret: gitlab-redis-credential-v1
      sentinels:
      - host: redis-tracechunks-01-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-tracechunks-02-db-gprd.c.gitlab-production.internal
        port: 26379
      - host: redis-tracechunks-03-db-gprd.c.gitlab-production.internal
        port: 26379

  pages:
    host: gitlab.io

  psql:
    host: pgbouncer.int.gprd.gitlab.net
    port: 6432
    load_balancing:
      discover:
        nameserver: <%= File.read('/etc/gitlab/instance_name').strip %>
        record: db-replica.service.consul.
        record_type: SRV
        port: 8600
        use_tcp: true
    ci:
      databaseTasks: false
      host: pgbouncer-ci.int.gprd.gitlab.net
      port: 6432
      load_balancing:
        discover:
          nameserver: <%= File.read('/etc/gitlab/instance_name').strip %>
          record: ci-db-replica.service.consul.
          record_type: SRV
          port: 8600
          use_tcp: true

  smtp:
    domain: mg.gitlab.com
    user_name: dotcom-rotated@mg.gitlab.com
